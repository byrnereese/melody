<mt:ignore><!-- FIXME: proper handling of show/hide this widget below --></mt:ignore>
<mt:setvar name="edit_screen" value="1">
<$mt:setvar name="show_display_options_link" value="1"$>
<mt:setvarblock name="display_options">
<div id="display-options-detail" class="unit size1of1 display-options-detail detail">
        <form id="display-options-form" method="post" action="<mt:var name="script_url">">
            <input type="hidden" id="entry_prefs" name="entry_prefs" value="<mt:if name="disp_prefs_default">Default<mt:else>Custom</mt:if>">
                <mtapp:setting
                    id="entry_fields"
                    label="<__trans phrase="Fields">"
                    label_class="display-options">
                    <ul id="entry-pref-field-list">
                        <mt:loop name="field_loop">
                        <mt:unless name="system_field"><mt:unless name="lock_field"><li class="dbx-box"><label class="dbx-handle"><input type="checkbox" name="custom_prefs" id="custom-prefs-<$mt:var name="field_id" escape="html"$>" value="<$mt:var name="field_name" escape="html"$>" onclick="setCustomFields(); return true" <mt:if name="lock_field"><mt:if name="show_field"> checked="checked"</mt:if> disabled="disabled"<mt:elseif name="show_field"> checked="checked"</mt:if> class="cb" /> <$mt:var name="field_label" escape="html"$></label></li><mt:else><li<mt:if name="use_field"> class="dbx-box"</mt:if>><label<mt:if name="use_field"> class="dbx-handle"</mt:if>><input type="checkbox" name="custom_prefs" id="custom-prefs-<$mt:var name="field_id" escape="html"$>" value="<$mt:var name="field_name" escape="html"$>" onclick="setCustomFields(); return true" <mt:if name="lock_field"><mt:if name="show_field"> checked="checked"</mt:if> disabled="disabled"<mt:elseif name="show_field"> checked="checked"</mt:if> class="cb" /> <$mt:var name="field_label" escape="html"$></label></li></mt:unless></mt:unless>
                        </mt:loop>
                    </ul>
                </mtapp:setting>
                <mtapp:setting
                    id="metadata_fields"
                    label="<__trans phrase="Metadata">"
                    label_class="display-options">
                    <ul>
                        <mt:if name="object_type" ne="page">
                        <li><label><input type="checkbox" name="custom_prefs" id="custom-prefs-category" value="category" onclick="setCustomFields(); return true"<mt:if name="disp_prefs_show_category"> checked="checked"</mt:if> class="cb" /> <__trans phrase="Categories"></label></li>
                        </mt:if>
                        <li><label><input type="checkbox" name="custom_prefs" id="custom-prefs-feedback" value="feedback" onclick="setCustomFields(); return true"<mt:if name="disp_prefs_show_feedback"> checked="checked"</mt:if> class="cb" /> <__trans phrase="Comments"></label></li>
                        <li><label><input type="checkbox" name="custom_prefs" id="custom-prefs-assets" value="assets" onclick="setCustomFields(); return true"<mt:if name="disp_prefs_show_assets"> checked="checked"</mt:if> class="cb" /> <__trans phrase="[_1] Assets" params="<mt:var name="object_label">"></label></li>
                    </ul>
                </mtapp:setting>
                <mtapp:setting
                    id="reset_display_options"
                    label="<__trans phrase="Reset display options">"
                    label_class="display-options"
                    show_label="0">
                    <a href="javascript:void(0)" onclick="return setDefaultFieldGroup();" title="<__trans phrase="Reset display options to blog defaults">" ><__trans phrase="Reset defaults"></a>
                </mtapp:setting>
            <div class="actions-bar display-options-actions-bar buttons">
                <button
                    onclick="saveEntryFieldOptions();"
                    title="<__trans phrase="Save display options">"
                    class="close-display-options"
                    ><__trans phrase="OK"></button>
            </div>
        </form>
</div>
</mt:setvarblock>

<$mt:setvar name="disp_prefs_show_revision" value="1"$>
<mt:if name="object_type" eq="page">
    <mt:if name="can_manage_pages">
        <$mt:setvar name="can_publish_post" value="1"$>
    </mt:if>
    <mt:if name="loaded_revision">
    <mt:setvarblock name="page_title"><__trans phrase="Edit Page"></mt:setvarblock>
    <mt:else>
    <$mt:setvar name="page_title" value="<__trans phrase="Edit Page">"$>
    </mt:if>
    <mt:if name="new_object">
        <$mt:setvar name="page_title" value="<__trans phrase="Create Page">"$>
    </mt:if>
    <$mt:setvar name="disp_prefs_show_category" value="1"$>
    <$mt:setvar name="container_label" value="<__trans phrase="Folder">"$>
    <$mt:setvar name="add_container_label" value="<__trans phrase="Add folder">"$>
    <$mt:setvar name="add_container_label_name" value="<__trans phrase="Add folder name">"$>
    <$mt:setvar name="add_new_container_label_parent" value="<__trans phrase="Add new folder parent">"$>
    <$mt:setvar name="manage_container_label" value="<__trans phrase="Manage Pages">"$>
    <$mt:setvar name="basename_label" value="<__trans phrase="Filename">"$>
    <$mt:setvar name="container_label_plural" value="<__trans phrase="Folders">"$>
    <$mt:setvar name="container_type" value="Folder">
    <$mt:setvar name="submit_button_title" value="<__trans phrase="Save this page (s)" escape="html">"$>
    <$mt:setvar name="preview_button_title" value="<__trans phrase="Preview this page (v)" escape="html">"$>
    <$mt:setvar name="delete_button_title" value="<__trans phrase="Delete this page (x)" escape="html">"$>
    <mt:if name="status_publish">
        <mt:if name="entry_permalink">
            <mt:setvarblock name="view_link">
                <a href="<$mt:var name="entry_permalink"$>" target="<__trans phrase="_external_link_target">"><__trans phrase="View Page"></a></li>
            </mt:setvarblock>
        </mt:if>
    </mt:if>
<mt:else>
    <mt:if name="loaded_revision">
    <mt:setvarblock name="page_title"><__trans phrase="Edit Entry"></mt:setvarblock>
    <mt:else>
    <$mt:setvar name="page_title" value="<__trans phrase="Edit Entry">"$>
    </mt:if>
    <mt:if name="new_object">
        <$mt:setvar name="page_title" value="<__trans phrase="Create Entry">"$>
    </mt:if>
    <$mt:setvar name="container_label" value="<__trans phrase="Category">"$>
    <$mt:setvar name="add_container_label" value="<__trans phrase="Add category">"$>
    <$mt:setvar name="add_container_label_name" value="<__trans phrase="Add category name">"$>
    <$mt:setvar name="add_new_container_label_parent" value="<__trans phrase="Add new category parent">"$>
    <$mt:setvar name="manage_container_label" value="<__trans phrase="Manage Entries">"$>
    <$mt:setvar name="basename_label" value="<__trans phrase="Basename">"$>
    <$mt:setvar name="container_label_plural" value="<__trans phrase="Categories">"$>
    <$mt:setvar name="container_type" value="Category">
    <$mt:setvar name="container_label_class" value="no-header"$>
    <$mt:setvar name="submit_button_title" value="<__trans phrase="Save this entry (s)" escape="html">"$>
    <$mt:setvar name="preview_button_title" value="<__trans phrase="Preview this entry (v)" escape="html">"$>
    <$mt:setvar name="delete_button_title" value="<__trans phrase="Delete this entry (x)" escape="html">"$>
    <mt:if name="status_publish">
        <mt:if name="entry_permalink">
            <mt:setvarblock name="view_link">
                <a href="<$mt:var name="entry_permalink"$>" target="<__trans phrase="_external_link_target">"><__trans phrase="View Entry"></a></li>
            </mt:setvarblock>
        </mt:if>
    </mt:if>
</mt:if>
<mt:setvartemplate name="action_buttons">
    <button
        mt:mode="save_entry"
        type="submit"
        accesskey="s"
        title="<mt:var name="submit_button_title">"
        class="primary button"
        ><__trans phrase="Save"></button>
    <button
        mt:mode="preview_entry"
        name="preview_entry"
        type="submit"
        accesskey="v"
        title="<mt:var name="preview_button_title">"
        ><__trans phrase="Preview"></button>
    <mt:if name="id">
    <button
        mt:command="do-remove-items"
        mt:object-singular="<mt:var name="object_label" lower_case="1" escape="html">"
        mt:object-plural="<mt:var name="object_label_plural" lower_case="1" escape="html">"
        mt:object-type="<mt:var name="object_type" escape="html">" mt:blog-id="<mt:var name="blog_id">"
        type="submit"
        accesskey="x"
        title="<mt:var name="delete_button_title">"
        ><__trans phrase="Delete"></button>
    </mt:if>
    <div id="autosave-notification-<$mt:var name="bar_position" escape="html" default="top"$>" class="autosave-notification"></div>
</mt:setvartemplate>
<mt:setvarblock name="system_msg">
    <div id="msg-block">
    <mt:unless name="recovered_object">
        <mt:if name="autosaved_object_exists">
            <mt:unless name="error">
            <mtapp:statusmsg
                id="recovered-object"
                class="info">
                <mt:if name="object_type" eq="entry">
                    <__trans phrase="A saved version of this entry was auto-saved [_2]. <a href="[_1]">Recover auto-saved content</a>" params="<mt:var name="script_url">?__mode=view&amp;_type=<mt:var name="object_type">&amp;_recover=1<mt:if name="id">&amp;id=<mt:var name="id" escape="url"></mt:if><mt:if name="blog_id">&amp;blog_id=<mt:var name="blog_id" escape="url"></mt:if>%%<mt:date ts="$autosaved_object_ts" relative="1">">
                <mt:else>
                    <__trans phrase="A saved version of this page was auto-saved [_2]. <a href="[_1]">Recover auto-saved content</a>" params="<mt:var name="script_url">?__mode=view&amp;_type=<mt:var name="object_type">&amp;_recover=1<mt:if name="id">&amp;id=<mt:var name="id" escape="url"></mt:if><mt:if name="blog_id">&amp;blog_id=<mt:var name="blog_id" escape="url"></mt:if>%%<mt:date ts="$autosaved_object_ts" relative="1">">
                </mt:if>
            </mtapp:statusmsg>
            </mt:unless>
        </mt:if>
    </mt:unless>
    <mt:if name="saved_added">
        <mtapp:statusmsg
            id="saved-added"
            class="success">
            <mt:if name="object_type" eq="entry">
                <__trans phrase="This entry has been saved.">
            <mt:else>
                <__trans phrase="This page has been saved.">
            </mt:if>
            <$mt:var name="view_link"$>
        </mtapp:statusmsg>
    </mt:if>
    <mt:if name="saved_changes">
        <mtapp:statusmsg
            id="saved-changes"
            class="success">
            <__trans phrase="Your changes have been saved.">
            <$mt:var name="view_link"$>
        </mtapp:statusmsg>
    </mt:if>
    <mt:if name="ping_errors">
        <mtapp:statusmsg
            id="ping-errors"
            class="alert">
            <__trans phrase="One or more errors occurred when sending update pings or TrackBacks."> <mt:if name="can_view_log"><__trans phrase="_USAGE_VIEW_LOG" params="<$mt:var name="script_url"$>?__mode=view_log&amp;blog_id=<$mt:var name="blog_id"$>"></mt:if>
        </mtapp:statusmsg>
    </mt:if>
    <mt:if name="saved_prefs">
        <mtapp:statusmsg    
            id="saved-prefs"
            class="success">
            <__trans phrase="Your customization preferences have been saved, and are visible in the form below.">
        </mtapp:statusmsg>
    </mt:if>
    <mt:if name="saved_comment">
        <mtapp:statusmsg    
            id="saved-comment"
            class="success"
            rebuild="all">
            <__trans phrase="Your changes to the comment have been saved.">
        </mtapp:statusmsg>
    </mt:if>
    <mt:if name="saved_notify">
        <mtapp:statusmsg    
            id="saved-notify"
            class="success">
            <__trans phrase="Your notification has been sent.">
        </mtapp:statusmsg>
    </mt:if>
    <mt:if name="recovered_object">
        <mtapp:statusmsg    
            id="recovered-object"
            class="success">
            <mt:if name="object_type" eq="entry">
                <__trans phrase="You have successfully recovered your saved entry.">
            <mt:else>
                <__trans phrase="You have successfully recovered your saved page.">
            </mt:if>
        </mtapp:statusmsg>
    </mt:if>
    <mt:if name="recovered_failed">
        <mtapp:statusmsg    
            id="recovered-failed"
            class="error">
            <mt:if name="object_type" eq="entry">
                <__trans phrase="An error occurred while trying to recover your saved entry.">
            <mt:else>
                <__trans phrase="An error occurred while trying to recover your saved page.">
            </mt:if>
        </mtapp:statusmsg>
    </mt:if>
    <mt:if name="saved_deleted">
        <mtapp:statusmsg    
            id="saved-deleted"
            class="success">
            <__trans phrase="You have successfully deleted the checked comment(s).">
        </mtapp:statusmsg>
    </mt:if>
    <mt:if name="saved_deleted_ping">
        <mtapp:statusmsg    
            id="saved-deleted-ping"
            class="success">
            <__trans phrase="You have successfully deleted the checked TrackBack(s).">
        </mtapp:statusmsg>
    </mt:if>
    <mt:if name="loaded_revision">
        <mtapp:statusmsg
            id="loaded_revision"
            class="info">
            <__trans phrase="Restored revision (Date:[_1]).  The current status is: [_2]" params="<$mt:var name="rev_date" escape="html"$>%%<span class="icon-left-wide icon-<$mt:var name="current_status_text" lower_case="1">"><$mt:var name="current_status_label"$></span>">
        </mtapp:statusmsg>
        <mt:if name="missing_tags_rev">
            <mtapp:statusmsg
                id="missing_tags_rev"
                class="info">
                <__trans phrase="Some of tags in the revision could not be loaded because they have been removed.">
            </mtapp:statusmsg>
        </mt:if>
        <mt:if name="missing_cats_rev">
            <mtapp:statusmsg
                id="missing_cats_rev"
                class="info">
                <__trans phrase="Some [_1] in the revision could not be loaded because they have been removed." params="<mt:if name="object_type" eq="entry">categories<mt:else>folders</mt:if>">
            </mtapp:statusmsg>
        </mt:if>
    </mt:if>
    <mt:if name="error">
        <mtapp:statusmsg
            id="generic-error"
            class="error">
            <mt:var name="error" escape="html">
        </mtapp:statusmsg>
    </mt:if>
    </div>
</mt:setvarblock>
<mt:setvarblock name="form_header">
    <form name="entry_form" id="entry_form" method="post" action="<$mt:var name="script_url"$>" mt:once="1" mt:auto-save="1" mt:auto-save-delay="<$mt:var name="autosave_frequency"$>000">
    <mt:if name="new_object">
        <input type="hidden" name="author_id" value="<$mt:var name="author_id" escape="html"$>" />
    <mt:else>
        <input type="hidden" name="id" value="<$mt:var name="id" escape="html"$>" />
    </mt:if>
        <input type="hidden" name="blog_id" value="<$mt:var name="blog_id" escape="html"$>" id="blog-id" />
        <input type="hidden" name="__mode" value="save_entry" />
        <input type="hidden" name="_type" value="<$mt:var name="object_type"$>" />
        <input type="hidden" name="return_args" value="<$mt:var name="return_args" escape="html"$>" />
        <input type="hidden" name="magic_token" value="<$mt:var name="magic_token"$>" id="m_t" />
        <input type="hidden" name="action_name" value="" />
        <input type="hidden" name="itemset_action_input" value="" />
        <input type="hidden" name="dirty" value="" />
     <mt:if name="use_revision">
        <input type="hidden" name="save_revision" id="save_revision" value="1" />
        <input type="hidden" name="current_revision" id="current_revision" value="<mt:var name="current_revision" default="0">" />
     </mt:if>
</mt:setvarblock>
<mt:setvarblock name="category_setting">
    <mtapp:setting
        id="category"
        label="$container_label"
        label_class="$container_label_class"
        help_page="entries"
        help_section="entry_categories">
    <script type="text/javascript">
        /* <![CDATA[ */
            MT.App.selectedCategoryList = <$mt:if name="selected_category_loop"><$mt:var name="selected_category_loop" to_json="1"$><mt:else>[]</mt:if>;
            MT.App.objectType = '<mt:var name="object_type" escape="js">';

            Template.templates.categoryList = '<mt:section encode_js="1">
                [# if ( !items.length ) { #]
                    <span class="disabled">[#|h trans("None selected") #]</span>
                    [#* return #]
                [# } #]
                <ul class="<$mt:var name="container_type" lower_case="1"$>-list pkg">
                [# var map = {}; #]
                [# for ( var i = 0; i < items.length; i++ ) { #]
                    [# if ( items[ i ] == 0 && i == 0 ) { #]
                        [#-- special case, no primary selected, but has secondaries --#]
                        [# continue #]
                    [# } #]
                    [# var cat = cache.getItem( "cat:"+items[ i ] ); #]
                    [# if ( !cat ) continue; #]
                    [# var label; #]
                    [# if ( cat.path.length ) {
                        label = [];
                        for ( var j = 0; j < cat.path.length; j++ ) {
                            var c = cache.getItem( "cat:"+cat.path[ j ] );
                            if ( c ) 
                                label.push( <mt:if name="object_type" ne="page">c.label<mt:else>c.basename</mt:if> );
                        }
                        label.push( <mt:if name="object_type" ne="page">cat.label<mt:else>cat.basename</mt:if> );
                        for ( var j = 0; j < label.length; j++ )
                            label[ j ] = context.f.h( label[ j ] );
                        label = label.join( <mt:if name="object_type" ne="page">' &raquo; '<mt:else>''</mt:if> );
                    } else {
                        label = context.f.h( <mt:if name="object_type" ne="page">cat.label<mt:else>cat.basename</mt:if> );
                    } #]
                    <mt:if name="object_type" ne="page">
                    [# if ( i == 0 ) { #]
                        <li class="principal pkg" mt:focus-hover="1" mt:id="[#= cat.id #]"><strong>[#= label #]</strong><a href="javascript:void(0);" mt:command="remove" class="delete" title="[#|h trans("Remove") #]">&nbsp;<span>[#|h trans("Remove") #]</span></a></li>
                    [# } else { #]
                        <li class="pkg" mt:focus-hover="1" mt:id="[#= cat.id #]"><mt:if name="object_type" eq="entry"><a mt:focus-hover="1" href="javascript:void(0);" mt:command="primary" class="principal" title="[#|h trans("Make primary") #]">[#= label #]</a></mt:if><a mt:focus-hover="1" href="javascript:void(0);" mt:command="remove" class="delete" title="[#|h "Remove" #]">&nbsp;<span>[#|h trans("Remove") #]</span></a></li>
                    [# } #]
                    <mt:else>
                    <li class="pkg" mt:focus-hover="1" mt:id="[#= cat.id #]">[#= label #]</li>
                    </mt:if>
                [# } #]
                </ul>
            </mt:section>';
        /* ]]> */
    </script>
        <mt:if name="object_type" eq="page">
        <div mt:delegate="category-list" id="category-list"></div>
        <a href="javascript:void(0);" class="change-folder-link" mt:command="open-category-selector" title="<__trans phrase="Add folder">"><__trans phrase="Change Folder"/></a>
        </mt:if>
        <mt:include name="include/category_selector.tmpl">
        <mt:if name="object_type" eq="entry">
        <div mt:delegate="category-list" id="category-list"></div>
        </mt:if>
        <input id="category-ids" type="hidden" name="category_ids" value="<$mt:var name="selected_category_loop" glue=","$>" />
    </mtapp:setting>
</mt:setvarblock>
<mt:setvarblock name="related_content">
    <mt:unless name="new_object">
        <mt:setvarblock name="stats_widget_id"><$mt:var name="object_type"$>-stats-widget</mt:setvarblock>
        <mtapp:widget
            id="$stats_widget_id"
            class="stats-widget"
            label="<__trans phrase="Stats">">
            <div class="object-status">
                <ul class="pkg">
                    <li class="object-status-detail">
                        <mt:if name="status_draft">
                            <span class="icon-left-wide icon-draft"><__trans phrase="Unpublished (Draft)"></span>
                        <mt:else name="status_review">
                            <span class="icon-left-wide icon-warning"><__trans phrase="Unpublished (Review)"></span>
                        <mt:else name="status_future">
                            <span class="icon-left-wide icon-future"><__trans phrase="Scheduled"></span>
                        <mt:else name="status_publish">
                            <span class="icon-left-wide icon-success"><__trans phrase="Published"></span>
                        <mt:else name="status_spam">
                            <span class="icon-left-wide icon-spam"><__trans phrase="Unpublished (Spam)"></span>
                        </mt:if>
                    </li>
                    <mt:if name="status_publish">
                        <mt:if name="entry_permalink">
                    <li class="view-entry-link"><a href="<$mt:var name="entry_permalink"$>" target="<__trans phrase="_external_link_target">" class="icon-left-wide icon-view"><__trans phrase="View"></a></li>
                        </mt:if>
                        <mt:if name="can_send_notifications">
                    <li><a href="javascript:void(0)" onclick="openDialog(null,'entry_notify','blog_id=<mt:var name="blog_id" escape="url">&amp;entry_id=<mt:var name="id" escape="url">');return false;" class="icon-left-wide icon-share"><__trans phrase="Share"></a></li>
                        </mt:if>
                    </mt:if>
                </ul>
            </div>
            <ul class="object-stats">
                <li class="comments-link"><__trans phrase="<a href="[_2]">[quant,_1,comment,comments]</a>" params="<$mt:var name="num_comments"$>%%<$mt:var name="script_url">?__mode=list_comments&amp;filter_key=_comments_by_entry&amp;filter_val=<$mt:var name="id" escape="url"$>&amp;blog_id=<$mt:var name="blog_id" escape="url"$>"></li>
                <li class="pings-link"><__trans phrase="<a href="[_2]">[quant,_1,trackback,trackbacks]</a>" params="<$mt:var name="num_pings"$>%%<$mt:var name="script_url">?__mode=list_pings&amp;filter=entry_id&amp;filter_val=<$mt:var name="id" escape="url"$>&amp;blog_id=<$mt:var name="blog_id" escape="url"$>"></li>
            </ul>
        </mtapp:widget>
    </mt:unless>
    
<div id="publishing-field"<mt:unless name="disp_prefs_show_publishing"> class="hidden"</mt:unless>>
    <mtapp:widget
        id="entry-publishing-widget"
        label="<__trans phrase="Publishing">">
        <mtapp:setting
            id="status"
            label="<__trans phrase="Status">"
            help_page="entries"
            help_section="status">
            <mt:unless name="sitepath_configured">
                            <input type="hidden" name="status" id="status" value="1" /><span><__trans phrase="Unpublished"></span>&nbsp;<span class="alert-warning-inline"><img src="<$mt:var name="static_uri"$>images/status_icons/warning.gif" alt="<__trans phrase="Warning">" width="9" height="9" /> <a href="<$mt:var name="script_url"$>?__mode=cfg_blog_settings&amp;id=<$mt:var name="blog_id"$>&amp;blog_id=<$mt:var name="blog_id"$>#publishing"><mt:if name="object_type" eq="entry"><__trans phrase="You must configure this blog before you can publish this entry."><mt:else><__trans phrase="You must configure this blog before you can publish this page."></mt:if></a></span>
            <mt:else>
                <mt:if name="can_publish_post">
                            <select name="status" id="status" class="full-width" onchange="highlightSwitch(this)">
                                <option value="1"<mt:if name="status_draft"> selected="selected"</mt:if>><__trans phrase="Unpublished (Draft)"></option>
                                <option value="2"<mt:if name="status_publish"> selected="selected"</mt:if>><__trans phrase="Published"></option>
                    <mt:if name="status_review">
                                <option value="3" selected="selected"><__trans phrase="Unpublished (Review)"></option>
                    <mt:else name="status_spam">
                                <option value="5" selected="selected"><__trans phrase="Unpublished (Spam)"></option>
                    </mt:if>
                    <mt:if name="new_object">
                                    <option value="4"<mt:if name="status_future"> selected="selected"</mt:if>><__trans phrase="Scheduled"></option>
                    <mt:else>
                        <mt:unless name="status_publish">
                                <option value="4"<mt:if name="status_future"> selected="selected"</mt:if>><__trans phrase="Scheduled"></option>
                        </mt:unless>
                    </mt:if>
                            </select>
                <mt:else>
                    <mt:if name="new_object">
                            <input type="hidden" name="status" id="status" value="1" /><span><__trans phrase="Unpublished"></span>
                    <mt:else>
                        <mt:if name="status_draft">
                            <input type="hidden" name="status" id="status" value="1" /><span><__trans phrase="Unpublished (Draft)"></span>
                        <mt:else name="status_publish">
                            <input type="hidden" name="status" id="status" value="2" /><span><__trans phrase="Published"></span>
                        <mt:else name="status_future">
                            <input type="hidden" name="status" id="status" value="4" /><span><__trans phrase="Scheduled"></span>
                        <mt:else name="status_review">
                            <input type="hidden" name="status" id="status" value="3" /><span><__trans phrase="Unpublished (Review)"></span>
                        <mt:else name="status_spam">
                            <input type="hidden" name="status" id="status" value="5" /><span><__trans phrase="Unpublished (Spam)"></span>
                        </mt:if>
                    </mt:if>
                </mt:if>
            </mt:unless>


<mt:unless name="new_object">
    <mt:if name="use_revision">
    <div class="revision-info">
        <mt:if name="rev_date">
        <p><__trans phrase="Revision: <strong>[_1]</strong>" params="<mt:var name="rev_date" escape="html">"></p>
        <a href="javascript:void(0);" 
           onclick="openDialog(null,'list_revision','_type=<mt:var name="object_type" default="entry">&id=<$mt:var name="id"$ escape="url">&blog_id=<mt:var name="blog_id">&r=<mt:var name="rev_number" escape="html">');return false;"
           title="<__trans phrase="View revisions of this [_1]" params="<mt:var name="object_label">">"><__trans phrase="View revisions"></a>
        <mt:else>
        <p class="zero-state"><__trans phrase="No revision(s) associated with this [_1]" params="<mt:var name="object_label" lower_case="1" escape="html">"></p>
        </mt:if>
    </div>
    <mt:else>
    <ul>
        <li><__trans phrase="[_1] - Created by [_2]" params="<$mt:date ts="$created_on_ts" relative="1" _default="$created_on_formatted"$>%%<$mt:var name="created_by" escape="html" escape="html"$>"></li>
        <mt:if name="status_publish">
        <li><__trans phrase="[_1] - Published by [_2]" params="<$MTDate ts="$authored_on_ts" relative="1" _default="$authored_on_formatted"$>%%<$mt:var name="author_name" escape="html" escape="html"$>"></li>
        </mt:if>
        <mt:if name="modified_by">
        <li><__trans phrase="[_1] - Edited by [_2]" params="<$MTDate ts="$modified_on_ts" relative="1" _default="$modified_on_formatted"$>%%<$mt:var name="modified_by" escape="html" escape="html"$>"></li>
        </mt:if>
    </ul>
    </mt:if>
</mt:unless>

        </mtapp:setting>

        <mt:if name="status_future">
            <$mt:setvar name="authored_on_label" value="<__trans phrase="Publish On">"$>
        <mt:else>
            <$mt:setvar name="authored_on_label" value="<__trans phrase="Publish Date">"$>
        </mt:if>
        <mtapp:setting
            id="authored_on"
            label="$authored_on_label"
            help_page="entries"
            help_section="date">
            <span class="date-time-fields<mt:if name="status_future"><mt:if name="can_publish_post"> highlight</mt:if></mt:if>">
                <input type="text" id="created-on" class="entry-date" name="authored_on_date" value="<$mt:var name="authored_on_date" escape="html"$>" />
                <a href="javascript:void(0);" class="date-picker" title="<__trans phrase="Select entry date">"><span>Choose Date</span></a>
                <input type="text" class="entry-time" name="authored_on_time" value="<$mt:var name="authored_on_time" escape="html"$>" />
            </span>
        </mtapp:setting>

        <mt:if name="object_type" eq="page">
            <$mt:var name="category_setting"$>
        </mt:if>

        <mtapp:setting
            id="basename"
            label="$basename_label"
            help_page="entries"
            help_section="basename">
                <input type="hidden" name="basename_old" id="basename_old" value="<$mt:var name="basename_old" escape="html"$>" />
                <input type="text" <mt:if name="object_type" eq="entry">disabled="disabled"</mt:if> name="basename" id="basename" value="<$mt:var name="basename" escape="html"$>" onchange="setElementValue('basename', dirify(this.value))" />
            <mt:if name="object_type" eq="page">
            <span class="file-extension"><$mt:var name="file_extension" escape="html"$></span>
            </mt:if>
            <mt:if name="object_type" eq="entry">
                <mt:if name="can_publish_post">
                <a href="javascript:void(0);" id="basename-lock" title="<__trans phrase="Unlock this entry&rsquo;s output filename for editing">"><span>Unlock</span></a>
                </mt:if>
                <p class="alert-warning-inline" id="basename-warning" style="display: none">
                    <img src="<$mt:var name="static_uri"$>images/status_icons/warning.gif" alt="<__trans phrase="Warning">" width="9" height="9" />
                <mt:if name="new_object">
                    <__trans phrase="Warning: If you set the basename manually, it may conflict with another entry.">
                <mt:else>
                    <__trans phrase="Warning: Changing this entry's basename may break inbound links.">
                </mt:if>
                </p>
                <input type="hidden" name="basename_manual" id="basename_manual" value="0" />
            <mt:else>
                <input type="hidden" name="basename_manual" id="basename_manual" value="1" />
            </mt:if>
        </mtapp:setting>
<mt:if name="use_revision">
    <mtapp:setting
        id="revision-note"
        label="<__trans phrase="Revision note">"
        label_class="left-label">
        <textarea name="revision-note" id="revision-note" class="full-width" rows="2"><mt:var name="revision-note" escape="html"></textarea>
    </mtapp:setting>
</mt:if>
    </mtapp:widget>
</div>
<div id="category-field"<mt:unless name="disp_prefs_show_category"> class="hidden"</mt:unless>>
    <mt:if name="object_type" eq="entry">
        <mt:setvarblock name="header_action">
            <a href="javascript:void(0)" class="add-new-category-link" id="open-category-selector1" mt:command="open-category-selector" mt:close-el="close-category-selector1" title="<__trans phrase="Add category">"><__trans phrase="edit"/></a>
            <a href="javascript:void(0)" class="add-category-toggle-link hidden" mt:command="close-category-selector" id="close-category-selector1"><__trans phrase="close"></a>
        </mt:setvarblock>
        <mtapp:widget
            id="entry-category-widget"
            label="<__trans phrase="Categories">"
            header_action="$header_action">
            <$mt:var name="category_setting"$>
        </mtapp:widget>
    </mt:if>
</div>
<div id="feedback-field"<mt:unless name="disp_prefs_show_feedback"> class="hidden"</mt:unless>>
    <mtapp:widget
        id="entry-feedback-widget"
        label="<__trans phrase="Feedback">">
        <mtapp:setting
            id="allow_feedback"
            label="<__trans phrase="Accept">"
            help_page="entries"
            help_section="accept_comments">
            <ul>
                <li><input type="checkbox" name="allow_comments" id="allow_comments" value="1"<mt:if name="allow_comments"> checked="checked"</mt:if> class="cb" /> <label for="allow_comments"><__trans phrase="Comments"/></label></li>
                <li><input type="checkbox" name="allow_pings" id="allow_pings" value="1"<mt:if name="allow_pings"> checked="checked"</mt:if> class="cb" /> <label for="allow_pings"><__trans phrase="TrackBacks"/></label></li>
            </ul>
        </mtapp:setting>

        <mt:unless name="new_object">
            <mt:if name="has_any_pinged_urls">
                <$mt:setvar name="show_ping_urls_hint" value="1"$>
                <mt:setvarblock name="ping_urls_hint">
                <a href="javascript:void(0)" onclick="listPreviousPings(); return false"><__trans phrase="View Previously Sent TrackBacks"></a>
                </mt:setvarblock>
            </mt:if>
        </mt:unless>
        <mtapp:setting
            id="ping_urls"
            label="<__trans phrase="Outbound TrackBack URLs">"
            hint="$ping_urls_hint"
            show_hint="$show_ping_urls_hint"
            help_page="entries"
            help_section="urls_to_ping">
                <textarea name="to_ping_urls" id="to_ping_urls" class="full-width short" cols="" rows=""><$mt:var name="to_ping_urls" escape="html"$></textarea>
        </mtapp:setting>

    </mtapp:widget>
    <mt:if name="agent_ie"><div>&nbsp;<!-- IE Duplicate Characters Bug -->&nbsp;</div></mt:if>
</div>

<mt:if name="object_type" like="(entry|page)">
<div id="assets-field"<mt:unless name="disp_prefs_show_assets"> class="hidden"</mt:unless>>
    <mtapp:widget
        id="asset_container"
        label="<__trans phrase="Assets">">
		<div class="asset-list-header">
        	<a href="javascript:void(0)" class="add-new-asset-link" 
           onclick="openDialog(null,'dialog_list_asset','_type=asset&edit_field=&blog_id=<mt:var name="blog_id">&dialog_view=1&no_insert=1');return false;">
            	<__trans phrase="Add New">
        	</a>
		</div>
        <ul id="asset-list" name="asset-list">
            <mt:if name="asset_loop">
                <mt:loop name="asset_loop">
                    <li id="list-asset-<mt:var name="asset_id">"
                        <mt:if name="asset_thumb">onmouseover="show('list-image-<mt:var name="asset_id">')"
                                                  onmouseout="hide('list-image-<mt:var name="asset_id">')"</mt:if> >
                        <a href="<mt:CGIPath><mt:AdminScript>?__mode=view&_type=asset&blog_id=<mt:var name="blog_id">&id=<mt:var name="asset_id">" class="asset-title">
                            <mt:var name="asset_name">
                        </a>
                        <a href="javascript:removeAssetFromList(<mt:var name="asset_id">)" class="remove-asset">
                            <img src="<mt:StaticWebPath>images/status_icons/close.gif" alt="Remove asset" />
                        </a>
	                    <mt:if name="asset_thumb">
	                        <img id="list-image-<mt:var name="asset_id">" class="list-image" src="<mt:var name="asset_thumb">" style="display:none" /> 
	                    </mt:if>
                    </li>
                </mt:loop>
            <mt:else>
                <li id="empty-asset-list"><__trans phrase="No asset(s) associated with this [_1]" params="<mt:var name="object_type">"></li>
            </mt:if>
        </ul>
        <input type="hidden" id="include_asset_ids" name="include_asset_ids" 
               value="<mt:loop name="asset_loop"><mt:var name="asset_id"><mt:unless name="__last__">,</mt:unless></mt:loop>" />
        <p class="notice"><__trans phrase="The published order of these assets can be changed using [_1]template tag modifiers[_2]." params="<a href="javascript:void(0)" onclick="return openManual('appendices', 'modifiers')">%%</a>"></p>
    </mtapp:widget>
</div>
</mt:if>

    <mt:if name="object_type" eq="page">
        <$MTApp:PageActions from="edit_page"$>
    <mt:else>
        <$MTApp:PageActions from="edit_entry"$>
    </mt:if>
</mt:setvarblock>

<mt:if name="rich_editor"><mt:var name="rich_editor_tmpl"><mt:else><mt:include name="include/archetype_editor.tmpl"></mt:if>

<mt:setvarblock name="js_include" prepend="1">

<script type="text/javascript">
/* <![CDATA[ */
Editor.strings.unsavedChanges = '<mt:if name="object_type" eq="entry"><__trans phrase="You have unsaved changes to this entry that will be lost." escape="js"><mt:else><__trans phrase="You have unsaved changes to this page that will be lost." escape="js"></mt:if>';
Editor.strings.enterEmailAddress = '<__trans phrase="Enter email address:" escape="js">';
Editor.strings.enterLinkAddress = '<__trans phrase="Enter the link address:" escape="js">';
Editor.strings.enterTextToLinkTo = '<__trans phrase="Enter the text to link to:" escape="js">';

var mt;
mt = { 
  screen: {
    position_actions_both: <mt:var name="position_actions_both" default="0">,
    position_actions_top: <mt:var name="position_actions_top" default="0">,
    position_actions_bottom: <mt:var name="position_actions_top" default="0">,
    re_edit: <mt:var name="reedit" default="0">,
    id: <mt:var name="id" default="0">,
    docs: {<mt:loop name="text_filters"><mt:unless name="__first__">, </mt:unless><$mt:var name="filter_key" escape="js"$>:'<$mt:var name="filter_docs" escape="js"$>'</mt:loop>},
    tag_list: <mt:if name="tags_js"><$mt:var name="tags_js"$><mt:else>undef</mt:if>,
    current_text_format: '<mt:var name="convert_breaks" escape="js">',
    orig_basename: '<mt:var name="basename" escape="js">',
    object_type: '<mt:var name="object_type" escape="js">',
    customizable_fields: ['publishing','feedback','assets'<mt:unless name="object_type" eq="page">,'category'</mt:unless>,<mt:loop name="field_loop" glue=","><mt:unless name="system_field"><mt:unless name="lock_field">'<mt:var name="field_id" escape="js">'<mt:else><mt:if name="use_field">'<mt:var name="field_id" escape="js">'</mt:if></mt:unless></mt:unless></mt:loop>],
    default_fields: [<mt:loop name="disp_prefs_default_fields" glue=",">'<mt:var name="name" escape="js">'</mt:loop>],
    tag_delim: '<$mt:var name="auth_pref_tag_delim"$>',
    basename_limit: <$mt:var name="basename_limit" escape="js"$>,
    trans: {
      PUBLISH_ON: '<__trans phrase="Publish On" escape="js">',
      PUBLISH_DATE: '<__trans phrase="Publish Date" escape="js">'
    }
  }
};
/* ]]> */
</script>

<!--// this MUST loaded after mt.js // -->
<script type="text/javascript" src="<$mt:var name="static_uri"$>js/tc/focus.js"></script>
<script type="text/javascript" src="<$mt:var name="static_uri"$>js/tc/client.js"></script>
<script type="text/javascript" src="<$mt:var name="static_uri"$>js/melody/fullscreen.js"></script>
<script type="text/javascript" src="<$mt:var name="static_uri"$>js/autocomplete.js"></script>
<script type="text/javascript" src="<$mt:var name="static_uri"$>js/edit.js?v=<$mt:var name="mt_version_id" escape="url"$>"></script>
<script type="text/javascript" src="<$mt:var name="static_uri"$>js/screens/edit_entry.js?v=<$mt:var name="mt_version_id" escape="url"$>"></script>

</mt:setvarblock>

<mt:setvarblock name="html_body" append="1">
    <mt:if name="dirty">
    <script type="text/javascript">
        /* <![CDATA[ */
            MT.App.dirty = true;
        /* ]]> */
    </script>
    </mt:if>
</mt:setvarblock>

<mt:unless name="new_object">
    <mt:setvarblock name="object_nav">
        <ul class="object-nav">
            <li id="previous-link"><mt:if name="previous_entry_id"><a href="<$mt:var name="script_url"$>?__mode=view&amp;_type=<$mt:var name="object_type" lower_case="1"$>&amp;id=<$mt:var name="previous_entry_id"$>&amp;blog_id=<$mt:var name="blog_id"$>"><__trans phrase="Previous"></a><mt:else><span><__trans phrase="Previous"></span></mt:if></li>
            <li id="manage-link"><a href="<$mt:var name="script_url"$>?__mode=list_<$mt:var name="object_type" lower_case="1"$>&amp;blog_id=<$mt:var name="blog_id"$>"><$mt:var name="manage_container_label"$></a></li>
            <li id="next-link"><mt:if name="next_entry_id"><a href="<$mt:var name="script_url"$>?__mode=view&amp;_type=<$mt:var name="object_type" lower_case="1"$>&amp;id=<$mt:var name="next_entry_id"$>&amp;blog_id=<$mt:var name="blog_id"$>"><__trans phrase="Next"></a><mt:else><span><__trans phrase="Next"></span></mt:if></li>
        </ul>
    </mt:setvarblock>
</mt:unless>
<mt:include name="include/header.tmpl" id="header_include">

    <mt:if name="junk_log_loop">
        <mtapp:statusmsg
            id="junk-message"
            can_close="0"
            class="alert">
        <mt:If name="status_review">
        <__trans phrase="This post was held for review, due to spam filtering.">
        <mt:Else>
        <__trans phrase="This post was classified as spam.">
        </mt:If>

        <div class="entry-spam-info">
            <a href="javascript:void(0)" onclick="toggleHidden('entry-feedback-rating'); toggleActive('spam-details-toggle'); return true" id="spam-details-toggle"><__trans phrase="Spam Details"></a>
        </div>
        <div id="entry-feedback-rating" class="hidden">
            <div id="spam-log-listing" class="listing">
                <table class="spam-log-listing-table" cellspacing="0">
                    <thead>
                    <tr>
                        <th id="jl-test"><__trans phrase="Test"></th>
                        <th id="jl-score"><__trans phrase="Score"></th>
                        <th id="jl-results"><__trans phrase="Results"></th>
                    </tr>
                    </thead>
                    <tbody>
            <mt:loop name="junk_log_loop">
                    <tr valign="top" class="<mt:if name="__odd__">odd<mt:else>even</mt:if>">
                        <td><mt:var name="test" escape="html"></td>
                        <td><mt:var name="score"></td>
                        <td><mt:var name="log"></td>
                    </tr>
            </mt:loop>
                    </tbody>
                </table>
            </div>
        </div>
        </mtapp:statusmsg>
    </mt:if>

    <mt:include name="include/actions_bar.tmpl" hide_pager="1">

    <mt:loop id="content_fields" name="field_loop">
        <mt:if name="__first__"><ul id="fields-col-1"></mt:if>
        <li id="sortable-field-<mt:var name="field_id">" class="sortable-field">
        <mt:if name="field_html">
            <mtapp:setting
                id="$field_id"
                label="$field_label"
                label_class="$label_class"
                hint="$description"
                shown="$show_field"
                content_class="$content_class"
                show_hint="$show_hint"
                required="$required">
                <$mt:var name="field_html"$>
            </mtapp:setting>
        <mt:else>
        <mt:if name="field_name" eq="title">
            <mtapp:setting
                id="title"
                label="<__trans phrase="Title">"
                label_class="top-label"
                help_page="entries"
                help_section="entry_title">
                <input type="text" name="title" id="title" value="<$mt:var name="title" escape="html"$>" maxlength="255" mt:watch-change="1" onkeyup="rebasename(this)" />
            </mtapp:setting>

        <mt:else eq="text">
            <mt:section id="text">

                <div id="text-field">
                <div id="editor">
                    <div id="editor-inner" class="editor-header pkg" mt:delegate="tab-container">
                        <div class="tab selected-tab" mt:command="set-editor-content" mt:tab="content">
                            <label><a href="javascript:void(0);"><__trans phrase="Body"></a></label>
                        </div>
                        <div class="tab" mt:command="set-editor-extended" mt:tab="extended">
                            <label><a href="javascript:void(0);"><__trans phrase="Extended"></a></label>
                        </div>

                        <!-- text filters -->
                        <div id="field-convert_breaks">
                            <__trans phrase="Format:">
                            <select name="convert_breaks" id="convert_breaks">
                <mt:loop name="text_filters">
                                <option value="<$mt:var name="filter_key"$>"<mt:if name="filter_selected"> selected="selected"</mt:if>><$mt:var name="filter_label" escape="html"$></option>
                </mt:loop>
                            </select>
                            <$mt:setvar name="show_formatting_help" value="1"$>
                            <mt:if name="convert_breaks" eq="richtext">
                                <$mt:setvar name="show_formatting_help" value="0"$>
                            </mt:if>
                            <mt:if name="convert_breaks" eq="0">
                                <$mt:setvar name="show_formatting_help" value="0"$>
                            </mt:if>
                            <mt:if name="convert_breaks" eq="__default__">
                                <$mt:setvar name="show_formatting_help" value="0"$>
                            </mt:if>
                            <a href="#" onclick="openTFDocs(); return false" id="formatting-help-link" class="help-link<mt:unless name="show_formatting_help"> disabled</mt:unless>">?</a>
                        </div>

                    </div>
                </div>
                <mt:include name="include/editor.tmpl">
                </div>

            </mt:section>

        <mt:else eq="tags">
            <mt:setvarblock name="show_metadata"><$mt:var name="disp_prefs_show_tags"$><mt:unless name="object_type" eq="page"><$mt:var name="disp_prefs_show_category"></mt:unless><$mt:var name="disp_prefs_show_excerpt"$><$mt:var name="disp_prefs_show_keywords"$></mtsetvarblock>

                <mt:if name="auth_pref_tag_delim_comma">
                    <$mt:setvar name="tags_hint" value="<__trans phrase="(comma-delimited list)">"$>
                <mt:else>
                    <mt:if name="auth_pref_tag_delim_space">
                        <$mt:setvar name="tags_hint" value="<__trans phrase="(space-delimited list)">"$>
                    <mt:else>
                        <mt:setvarblock name="tags_hint">
                            <__trans phrase="(delimited by '[_1]')" params="<$mt:var name="auth_pref_tag_delim"$>">
                        </mt:setvarblock>
                    </mt:if>
                </mt:if>

                <mtapp:setting
                    id="tags"
                    shown="$show_field"
                    label="<__trans phrase="Tags">"
                    label_class="top-label"
                    hint="$tags_hint"
                    help_page="entries"
                    help_section="entry_tags">
                    <div class="textarea-wrapper">
                        <input type="text" name="tags" id="tags" class="full-width" value="<$mt:var name="tags" escape="html"$>" mt:watch-change="1" autocomplete="off" />
                        <input type="hidden" name="_ignore_tags" id="tags-cache" value="<$mt:var name="tags" escape="html"$>" />
                    </div>
                    <!-- FIXME - move this styling to the ie hacks css file -->
                    <!--[if lte IE 6.5]><div style="position:relative;"><![endif]-->
                    <div id="tags_completion"></div>
                    <!--[if lte IE 6.5]></div><![endif]-->
                </mtapp:setting>

        <mt:else eq="excerpt">
            <mtapp:setting
                id="excerpt"
                shown="$show_field"
                label="<__trans phrase="Excerpt">"
                label_class="top-label"
                help_page="entries"
                help_section="excerpt">
                <textarea name="excerpt" id="excerpt" class="full-width short" cols="" rows="" mt:watch-change="1"><$mt:var name="excerpt" escape="html"$></textarea>
            </mtapp:setting>

        <mt:else eq="keywords">
            <mtapp:setting
                id="keywords"
                shown="$show_field"
                label="<__trans phrase="Keywords">"
                label_class="top-label"
                help_page="entries"
                help_section="keywords">
                <div class="textarea-wrapper">
                    <input type="text" name="keywords" id="keywords" class="full-width" value="<$mt:var name="keywords" escape="html"$>" mt:watch-change="1" autocomplete="off" />
                </div>
            </mtapp:setting>

        </mt:if>
        </mt:if>
        </li>
        <mt:if name="__last__"></ul></mt:if>
    </mt:loop>

<mt:include name="include/actions_bar.tmpl" bar_position="bottom" hide_pager="1">

<div id="quickpost">
    <mt:var name="quickpost_js">
</div>
<mt:setvarblock name="form_footer">
</form>
</mt:setvarblock>

<mt:include name="include/footer.tmpl" id="footer_include">
